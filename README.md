# 🎯 Amazon商品参入判定ツール

Keepa API・RainforestAPI・Claude AIを組み合わせて、「参入すべき商品」を自動判定するStreamlitアプリケーションです。月間販売数トレンド・競合分析・低評価レビュー分析で、販売チャンスを発見します。

## 📋 目次

- [主な機能](#主な機能)
- [技術スタック](#技術スタック)
- [セットアップ](#セットアップ)
- [使い方](#使い方)
- [API仕様と制限事項](#api仕様と制限事項)
- [ディレクトリ構成](#ディレクトリ構成)
- [トラブルシューティング](#トラブルシューティング)
- 🚀 **[製品ビジョン（理想的な姿）](VISION.md)** - プロマーケター向け完全版の構想

---

## 🎯 主な機能

### 1. 商品選定スコアリング（NEW! 🆕）
- **月間販売数トレンド**: Keepa APIの`monthlySoldHistory`から実際の販売数を取得
- **商品選定スコア（100点満点）**: 4つの指標で自動評価
  - 📈 **販売トレンド（40点）**: 販売数の成長率
  - 💰 **市場規模（30点）**: 月間販売数の規模
  - 🔧 **改善余地（20点）**: 評価の低さ（改善余地の大きさ）
  - 🚪 **参入難易度（10点）**: 競合の少なさ（新品出品者数）
- **推奨度表示**: スコアに応じて「🔥超推奨」「⭐推奨」「✅検討価値あり」を自動判定
- **詳細データ可視化**: 販売数推移（現在/6ヶ月前/12ヶ月前）を表示

### 2. 商品検索
- **キーワード検索**: 任意の商品カテゴリで検索
- **RainforestAPI連携**: amazon.co.jpから動的に商品ASINを取得
- **Keepa API連携**: 価格、ランキング、販売数などの詳細データを取得
- **スコア順ソート**: 商品選定スコアが高い順にTOP5を表示

### 3. レビュー収集
- **自動収集**: RainforestAPI（productエンドポイント）からレビューを取得
- **低評価優先ソート**: 取得したレビューを評価順（昇順）にソート（AI分析用）
- **商品ごとに統合表示**: 各商品のexpander内でレビュー収集と分析が完結
- **CSV出力**: 収集したレビューをCSV形式でダウンロード

### 4. AI分析（Claude Sonnet 4.5）
- **低評価レビュー分析**: ★3以下のレビューを自動抽出して分析
- **問題点分類**: カテゴリ別に問題を整理
- **改善提案**: 具体的な製品改善アイデアを生成
- **新商品コンセプト**: 競合の弱点を補う新商品案を提示
- **注**: レビューは低評価優先で収集されるため、問題点の抽出に最適化されています

---

## 📊 商品選定スコアの計算方法（詳細）

### スコアリングの全体構造

**合計100点満点**で、以下の4つの指標で評価：

| 指標 | 配点 | 重要度 | 評価対象 |
|------|------|--------|---------|
| 📈 販売トレンド | 40点 | 最重要 | 販売数の成長率 |
| 💰 市場規模 | 30点 | 重要 | 月間販売数の絶対値 |
| 🔧 改善余地 | 20点 | 中程度 | 顧客評価の低さ |
| 🚪 参入難易度 | 10点 | 補助 | 価格帯の適切さ |

---

### 1️⃣ 販売トレンドスコア（40点）

**計算式:**
```
販売成長率 = ((現在の月間販売数 - 6ヶ月前の月間販売数) / 6ヶ月前の月間販売数) × 100
```

**スコアリング:**

| 成長率 | 得点 | 判定 | マーケター視点の意味 |
|--------|------|------|---------------------|
| +100%以上 | 40点 | 🔥 爆発的成長 | 需要が急拡大中。今すぐ参入すべき |
| +50%以上 | 30点 | 📈 急成長中 | 市場拡大期。早期参入で先行者利益 |
| +20%以上 | 20点 | ↗️ 成長中 | 安定成長市場。リスク低め |
| +0%以上 | 10点 | → 微増 | 成熟市場。差別化必須 |
| 0%未満 | 0点 | ⚠️ 縮小中 | 避けるべき（トレンド終了） |

**注意点:**
- 6ヶ月前のデータがない場合は12ヶ月前で計算
- Keepa APIの`monthlySold`と`monthlySoldHistory`から取得

---

### 2️⃣ 市場規模スコア（30点）

**計算式:**
```
現在の月間販売数（monthlySold）
```

**スコアリング:**

| 月間販売数 | 得点 | 判定 | マーケター視点の意味 |
|-----------|------|------|---------------------|
| 5,000個以上 | 30点 | 💎 マス市場 | 十分な市場規模。スケール可能 |
| 3,000個以上 | 25点 | 💰 大市場 | 収益性十分。競合も多い |
| 1,000個以上 | 20点 | 📦 中市場 | バランス良好。狙い目 |
| 500個以上 | 15点 | 🎯 ニッチ市場 | 小規模ビジネス向け |
| 100個以上 | 10点 | 🌱 萌芽期 | テスト参入レベル |
| 100個未満 | 5点 | ⚠️ 超ニッチ | リスク高い |

**マーケター視点の補足:**
- **5,000個以上**: 年間売上6,000万円以上（単価1,000円想定）の市場
- **1,000個以上**: 競合が多すぎず少なすぎず、最も参入しやすい
- **100個未満**: 市場が小さすぎてスケールしにくい

---

### 3️⃣ 改善余地スコア（20点）

**計算式:**
```
Amazon評価（★1〜5）
```

**スコアリング:**

| 評価 | 得点 | 判定 | マーケター視点の意味 |
|------|------|------|---------------------|
| ★3.5未満 | 20点 | 🎯 改善余地大 | 顧客不満が多い。差別化チャンス |
| ★3.5〜3.9 | 15点 | 🔧 改善余地あり | 明確な問題点あり。改良で勝てる |
| ★4.0〜4.2 | 10点 | ✨ やや不満 | 細かい改善で差別化可能 |
| ★4.3〜4.4 | 5点 | 😊 概ね満足 | 差別化が難しい |
| ★4.5以上 | 0点 | 🏆 高評価 | 改良の余地なし。避けるべき |

**マーケター視点の補足:**
- **★3.5未満**: レビュー分析で問題点を特定し、改良版で勝負
- **★4.0〜4.2**: 「惜しい」商品。細部の改善で高評価を狙える
- **★4.5以上**: 既に完成度が高い。参入しても差別化困難

---

### 4️⃣ 参入難易度スコア（10点）

**計算式:**
```
新品出品者数（COUNT_NEW）
```

**スコアリング:**

| 新品出品者数 | 得点 | 判定 | マーケター視点の意味 |
|------------|------|------|---------------------|
| 1〜3社 | 10点 | 🌊 ブルーオーシャン | 競合ほぼゼロ。先行者利益を独占できる |
| 4〜10社 | 7点 | ✅ 競合少なめ | 適度な競争。差別化で勝てる |
| 11〜30社 | 5点 | 🆗 普通 | 標準的な競争環境 |
| 31〜50社 | 3点 | ⚠️ 競合多め | 差別化が必須。価格競争リスク |
| 51社以上 | 1点 | 🔴 レッドオーシャン | 過当競争。参入は避けるべき |

**マーケター視点の補足:**
- **1〜3社**: 独占市場に近い状態。ブランド確立のチャンス
- **4〜10社**: 健全な競争環境。品質と価格で差別化可能
- **31社以上**: 価格競争に巻き込まれるリスク大。避けるべき
- **注意**: 出品者数が0の場合は中間値（5点）を付与

---

### 🎯 総合スコアの判定基準

| スコア | 推奨度 | 判定 | アクション |
|--------|--------|------|-----------|
| 80点以上 | 🔥 超推奨 | 今すぐ参入すべき | レビュー分析→改良版開発 |
| 60〜79点 | ⭐ 推奨 | 参入価値あり | 詳細調査→テスト販売 |
| 40〜59点 | ✅ 検討価値あり | 慎重に判断 | 競合分析必須 |
| 40点未満 | ⚠️ 要慎重検討 | リスク高い | 避けるか、詳細分析後に判断 |

---

### 📐 スコアリングの計算例

**商品A（ヨガマット）の場合:**

```
【データ】
- 現在の月間販売数: 3,500個
- 6ヶ月前の月間販売数: 2,000個
- 評価: ★3.8
- 新品出品者数: 2社

【計算】
1. 販売トレンド:
   成長率 = (3,500 - 2,000) / 2,000 × 100 = +75%
   → 50%以上100%未満 = 30点

2. 市場規模:
   3,500個 → 3,000個以上 = 25点

3. 改善余地:
   ★3.8 → 3.5〜3.9の範囲 = 15点

4. 参入難易度:
   2社 → 1〜3社の範囲（ブルーオーシャン） = 10点

【合計スコア】
30 + 25 + 15 + 10 = 80点
→ 🔥 超推奨（今すぐ参入すべき）
```

---

## 🛠️ 技術スタック

| カテゴリ | 技術 |
|---------|------|
| **フロントエンド** | Streamlit 1.32.0 |
| **データ分析** | Pandas, Plotly |
| **API統合** | Keepa API, RainforestAPI, Claude API (Anthropic) |
| **言語** | Python 3.9+ |

---

## 📦 セットアップ

### 1. リポジトリのクローン

```bash
git clone <repository-url>
cd market
```

### 2. 仮想環境の作成・有効化

```bash
python -m venv venv

# Windows (Git Bash)
source venv/Scripts/activate

# macOS/Linux
source venv/bin/activate
```

### 3. 依存関係のインストール

```bash
pip install -r requirements.txt
```

### 4. 環境変数の設定

`.env`ファイルを作成し、APIキーを設定：

```env
KEEPA_API_KEY=your_keepa_api_key_here
RAINFOREST_API_KEY=your_rainforest_api_key_here
CLAUDE_API_KEY=your_claude_api_key_here
```

**APIキーの取得方法:**
- **Keepa API**: [https://keepa.com/#!api](https://keepa.com/#!api)
- **RainforestAPI**: [https://www.rainforestapi.com/](https://www.rainforestapi.com/)
- **Claude API**: [https://console.anthropic.com/](https://console.anthropic.com/)

### 5. アプリケーションの起動

```bash
streamlit run app.py
```

ブラウザで `http://localhost:8501` が自動的に開きます。

---

## 📖 使い方

### ステップ1: 商品を検索して改良候補を発見

1. **APIキーの設定**
   - サイドバーで各APIキーを入力（または`.env`から自動読み込み）
   - 最低限必要: Keepa API + RainforestAPI

2. **検索実行**
   - メイン画面で検索キーワードを入力（例: ヨガマット、ダンベル、プロテインシェーカー）
   - 「🔍 検索」ボタンをクリック

3. **結果確認**
   - **TOP5が商品選定スコア順**に表示されます
   - 1位の商品が自動的に展開されます
   - 各商品のexpanderを開くと以下が表示：
     - 📊 **商品選定スコア** (100点満点)
     - 🎯 **推奨度** (🔥超推奨、⭐推奨、✅検討価値あり、⚠️要慎重検討)
     - 💰 **価格・評価・月間販売数**
     - 📈 **販売数推移** (現在/6ヶ月前/12ヶ月前)
     - 📊 **スコア内訳** (4項目の得点)

**判断のポイント:**
- **スコア80点以上**: 🔥 今すぐこの商品を改良すべき！
- **スコア60点以上**: ⭐ 改良する価値あり
- **スコア40点以上**: ✅ 詳細調査後に判断

**注意**: 連続検索するとKeepa APIトークン待機が発生します（約30分間隔推奨）

---

### ステップ2: レビューを収集して問題点を把握

**方法A: 自動収集（推奨）**

1. 各商品のexpander内にある **「📝 レビューを収集」ボタン** をクリック
2. RainforestAPIからレビューが自動取得されます
3. **「📋 レビュープレビュー」** で最新3件を確認
4. **「💾 CSV」ボタン** で全レビューをダウンロード可能

---

### ステップ3: AI分析で改善ポイントを抽出

1. **Claude APIキーを設定**（サイドバー）

2. **一括分析を実行**
   - 画面下部の「📊 一括分析開始」ボタンをクリック
   - 数十秒待つと分析結果が表示されます

3. **分析結果を確認**
   - **📊 カテゴリ別問題点**: 配送・品質・デザインなど6項目で分類
   - **💡 改善提案**: 具体的な製品改善アイデア（実現可能性・コスト影響付き）
   - **🎯 新商品コンセプト**: 競合の弱点を補う新商品案
   - **📈 詳細データ**: 評価分布・レビュー一覧

4. **次のアクション**
   - 低評価レビューの問題点を製品仕様に反映
   - 改善提案を元に試作品を開発
   - 新商品コンセプトでテスト販売

---

### 📋 実践例：ヨガマットで新商品開発

```
1. 検索
   → 「ヨガマット」で検索
   → スコア78点の商品を発見（⭐推奨）

2. スコア分析
   → 販売トレンド: 30点（+60%成長）
   → 市場規模: 25点（月間3,200個）
   → 改善余地: 15点（★3.9 = 問題あり）
   → 参入難易度: 10点（$22 = 理想的）
   判断: 改良する価値あり！

3. レビュー収集
   → 15件のレビューを取得
   → 「滑りやすい」「臭いが気になる」という不満を発見

4. AI分析
   → 問題点: 「素材の滑り止め性能不足」「ゴム臭」
   → 改善提案: 「TPE素材採用」「表面テクスチャー改良」
   → 新商品案: 「無臭・超グリップ・洗えるヨガマット」

5. 開発
   → TPE素材で試作品を作成
   → テスト販売で★4.7を獲得
   → 月間1,000個販売達成！
```

---

## ⚠️ API仕様と制限事項

### Keepa API

| 項目 | 詳細 |
|------|------|
| **プラン** | Basic（無料） |
| **トークン制限** | ⚠️ **1トークン/分**（連続検索は約30分間隔が必要） |
| **商品取得上限** | 10件/検索（トークン制限対応） |
| **データ期間** | 過去90日の統計 |
| **トレンド計算** | レビュー数の増加率（90日前 vs 現在）を自動算出 |

**重要**: Keepa APIのBasicプランは1分間に1トークンのみ利用可能です。連続して検索を実行すると、トークンが回復するまで待機時間（最大30分程度）が発生します。本格的に使用する場合は有料プランをご検討ください。

### RainforestAPI

| 項目 | 詳細 |
|------|------|
| **検索機能** | ✅ 正常動作（`type=search`） |
| **商品情報** | ✅ 正常動作（`type=product`） |
| **レビュー専用EP** | ❌ **現在利用不可**（`type=reviews`は503エラー） |
| **代替手段** | `type=product`の`top_reviews`フィールドを使用 |
| **レビュー取得数** | 約10-20件/商品（`top_reviews`の制限） |

**重要**: RainforestAPIの`reviews`エンドポイントは2025年11月7日時点で一時的に利用不可です。このため、`product`エンドポイントから`top_reviews`を取得する方式に変更しています。

### Claude API

| 項目 | 詳細 |
|------|------|
| **モデル** | Claude Sonnet 4.5 |
| **用途** | レビュー分析・改善提案生成 |
| **入力データ** | ★3以下のレビュー |

---

## 📁 ディレクトリ構成

```
market/
├── app.py                          # メインアプリケーション
├── .env                            # 環境変数（APIキー）
├── requirements.txt                # Python依存関係
├── sample_reviews.csv              # サンプルレビューデータ
├── test_rainforest.py              # RainforestAPIテストスクリプト
├── README.md                       # このファイル
│
├── modules/                        # カスタムモジュール
│   ├── keepa_analyzer.py           # Keepa API分析（旧版）
│   ├── keepa_analyzer_simple.py    # Keepa API分析（シンプル版・現在使用中）
│   ├── review_collector.py         # レビュー収集（productエンドポイント経由）
│   └── claude_analyzer.py          # Claude AI分析
│
└── venv/                           # Python仮想環境（git管理外）
```

---

## 🔧 トラブルシューティング

### 問題1: Keepa APIでトークンエラー（連続検索時）

**エラー**: `"Waiting XXXX seconds for additional tokens"`（最大30分程度の待機時間）

**原因**: Keepa APIのBasicプランは1トークン/分の制限があり、連続で検索すると前回のトークンが回復するまで待機が必要です

**解決策**:
- ⏰ **表示された待機時間を待つ**（トークンが自動回復）
- ⏸️ **検索を中止して30分後に再試行**する
- 💰 **Keepa APIの有料プラン**に切り替える（推奨: 本格利用の場合）
- 📊 既に取得済みの結果を活用する（レビュー収集・AI分析は可能）

**補足**: 検索結果は10件に制限済み（`keepa_analyzer_simple.py`で対応済み）

### 問題2: RainforestAPIでレビューが0件

**エラー**: `"csvダウンロード(0件)"`

**原因**: `reviews`エンドポイントが現在利用不可（503エラー）

**解決策**:
- ✅ **既に対応済み**: `product`エンドポイントの`top_reviews`を使用するように修正済み
- RainforestAPIからレビューを取得できます
- より多くのレビューが必要な場合は、RainforestAPIの有料プランをご検討ください

### 問題3: Claude API分析が失敗する

**エラー**: `"❌ 分析エラー: ..."`

**確認事項**:
1. `.env`ファイルに正しいClaude APIキーが設定されているか
2. レビューデータが収集されているか（サイドバーで確認）
3. インターネット接続が安定しているか

### 問題4: 文字化けが発生する

**症状**: CSV出力時に日本語が文字化け

**解決策**:
- CSVは`UTF-8-BOM`エンコーディングで保存されています
- Excelで開く場合は自動的に正しく表示されます
- テキストエディタで開く場合は`UTF-8`を指定してください

---

## 📊 動作確認済み環境

- **OS**: Windows 10/11（Git Bash）、macOS、Linux
- **Python**: 3.9以上
- **ブラウザ**: Chrome 120+, Firefox 120+, Edge 120+

---

## 🚀 今後の改善予定

- [x] ✅ トレンド分析機能（レビュー増加率）
- [x] ✅ シンプルなランキング表UI
- [ ] Keepa APIの有料プランに対応して取得件数を増加
- [ ] RainforestAPIの`reviews`エンドポイント復旧時の対応
- [ ] 価格推移グラフの可視化
- [ ] より詳細な競合分析レポート生成
- [ ] 複数カテゴリの横断分析
- [ ] レビューの感情分析機能
- [ ] BSRランキング推移のグラフ化

---

## 📝 変更履歴

### 2025-11-07 v2.0 (最新) 🎉
- 🆕 **月間販売数トレンド分析**: Keepa APIの`monthlySoldHistory`から実際の販売数を取得
- 🆕 **商品選定スコア機能**: 販売トレンド・市場規模・改善余地・参入難易度を100点満点で評価
- 🆕 **推奨度自動判定**: スコアに基づき「🔥超推奨」「⭐推奨」「✅検討価値あり」を表示
- 🆕 **販売数推移表示**: 現在/6ヶ月前/12ヶ月前の販売数を可視化
- ✅ **UIを大幅改善**: expander形式で商品ごとに詳細データを表示
- ✅ **スコア内訳表示**: 4つの評価項目の得点を個別に表示
- ✅ **レビュー収集統合**: 商品詳細内でレビュー収集とプレビューが完結
- 📊 ソート基準を「レビュー増加率」から「商品選定スコア」に変更

### 2025-11-07 v1.0
- ✅ 月間販売数トレンド機能を追加（Keepa `monthlySoldHistory`使用）
- ✅ 商品選定スコアリング実装（100点満点、4指標）
- ✅ 参入難易度スコアに新品出品者数（競合分析）を採用
- ✅ 価格表示を円に修正（amazon.co.jp対応）
- ✅ RainforestAPI `product`エンドポイントからレビュー取得に変更
- ✅ レビューを低評価優先（昇順）でソート（AI分析の精度向上）

### 2025-11-06
- ✅ 初版リリース
- ✅ Keepa API, RainforestAPI, Claude API統合
- ✅ Streamlit UIの実装

---

## 📧 サポート

問題が発生した場合は、以下を確認してください：
1. このREADMEのトラブルシューティングセクション
2. `.env`ファイルのAPIキー設定
3. `requirements.txt`の依存関係が正しくインストールされているか

---

**Powered by Keepa API | RainforestAPI | Claude Sonnet 4.5**

© 2025 Amazon競合分析ツール for フィットネス
