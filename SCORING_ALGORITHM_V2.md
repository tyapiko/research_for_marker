# スコアリングアルゴリズム v2.0

**実装日**: 2025-01-16
**バージョン**: v2.0（収益性重視型）
**目的**: 収益性の低い商品を自動排除し、実際に利益が出る商品のみを推奨

---

## 🎯 v2.0の主要改善点

### 旧版（v1.0）の問題点
❌ **収益性が完全に欠落**
- 利益率-10%の商品でも高スコアになる致命的な欠陥
- 例：¥500のスマホケース（販売数5000個/月）→ 51点（検討価値あり）
  - 実際は赤字商品なのに推奨される

❌ **市場規模が販売数のみで評価**
- 低単価×大量販売 vs 高単価×中量販売を適切に区別できない
- 例：¥1000×5000個 = 500万円市場 vs ¥5000×1000個 = 500万円市場が同評価

❌ **競合評価が出品者数のみ**
- レビュー数を無視（3000件のレビューがある商品は改善困難）

❌ **成長性が短期のみ**
- 6ヶ月の成長率のみで判断（一時的なトレンドを過大評価）

---

## 📊 新スコアリング配分（100点満点）

| メトリクス | 配点 | 重要度 | 説明 |
|-----------|------|--------|------|
| **💵 収益性** | **35点** | 最重要 | 利益率・ROIを評価 |
| 💰 市場魅力度 | 25点 | 重要 | 金額ベースの市場規模 |
| 🏃 競合難易度 | 20点 | 重要 | 出品者数＋レビュー数 |
| 📈 成長性 | 20点 | 重要 | 短期＋長期トレンド |

---

## 1️⃣ 収益性スコア（35点）NEW!

### 計算ロジック

#### コスト構造（簡易版）
```python
product_cost = price × 0.60        # 原価60%
shipping_cost = price × 0.15       # 配送費15%
amazon_fee = price × 0.15          # Amazon手数料15%
fba_fee = 350円                    # FBA手数料（平均）

net_profit = price - product_cost - shipping_cost - amazon_fee - fba_fee
```

#### 利益率スコア（20点）
| 利益率 | スコア | 評価 |
|--------|--------|------|
| 30%以上 | 20点 | 🟢 優秀 |
| 25-30% | 17点 | 🟢 良好 |
| 20-25% | 14点 | 🟡 標準 |
| 15-20% | 10点 | 🟡 最低ライン |
| 10-15% | 5点 | 🔴 低い |
| 10%未満 | 0点 | 🔴 推奨しない |

#### ROIスコア（15点）
| ROI | スコア | 評価 |
|-----|--------|------|
| 100%以上 | 15点 | 投資額の2倍以上の利益 |
| 75-100% | 12点 | 優秀 |
| 50-75% | 9点 | 良好 |
| 30-50% | 6点 | 標準 |
| 15-30% | 3点 | 低い |
| 15%未満 | 0点 | 推奨しない |

### 実例比較

**Case 1: ヨガマット（推奨）**
- 価格: ¥3,500
- 原価: ¥2,100（60%）
- 配送: ¥525（15%）
- Amazon手数料: ¥525（15%）
- FBA: ¥350
- **純利益: ¥0（利益率0%、ROI 0%）**
- **収益性スコア: 0点** ← 正しく赤字を検出

**Case 2: プロ仕様ヨガマット（超推奨）**
- 価格: ¥4,980
- 原価: ¥2,988（60%）
- 配送: ¥747（15%）
- Amazon手数料: ¥747（15%）
- FBA: ¥350
- **純利益: ¥148（利益率3.0%、ROI 4.0%）**
- **収益性スコア: 0点** ← 利益率3%では推奨しない

---

## 2️⃣ 市場魅力度スコア（25点）IMPROVED

### 計算ロジック

#### 月間市場規模（金額ベース）
```python
monthly_market_size = monthly_sold_current × price
```

| 市場規模 | スコア | 評価 |
|----------|--------|------|
| ¥30M/月以上 | 25点 | 超大型市場 |
| ¥20-30M/月 | 22点 | 大型市場 |
| ¥10-20M/月 | 18点 | 中型市場 |
| ¥5-10M/月 | 14点 | 小型市場 |
| ¥2-5M/月 | 10点 | ニッチ市場 |
| ¥500K-2M/月 | 6点 | 超ニッチ |
| ¥500K未満 | 2点 | マイクロ市場 |

#### 価格帯調整
| 価格帯 | 調整 | 理由 |
|--------|------|------|
| ¥2,000-7,000 | 調整なし | Amazon FBA最適価格帯 |
| ¥1,000-2,000 or ¥7,000-15,000 | -10% | 手数料率が悪化 |
| その他 | -30% | FBA非推奨価格帯 |

### 改善効果
- **旧版**: ¥1000×5000個 = 30点（販売数のみ評価）
- **v2.0**: ¥1000×5000個 = 500万円 → 14点 × 0.9（価格調整） = 12点
- **v2.0**: ¥5000×1000個 = 500万円 → 14点（調整なし）

→ 同じ市場規模でも**高単価商品を優遇**

---

## 3️⃣ 競合難易度スコア（20点）IMPROVED

### 出品者数スコア（10点）
| 出品者数 | スコア | 評価 |
|----------|--------|------|
| 1-3社 | 10点 | 🟢 ブルーオーシャン |
| 4-10社 | 8点 | 🟢 競合少 |
| 11-30社 | 6点 | 🟡 標準 |
| 31-50社 | 4点 | 🔴 競合多 |
| 51-100社 | 2点 | 🔴 レッドオーシャン |
| 100社以上 | 1点 | 🔴 超激戦 |

### レビュー数スコア（10点）NEW!
| レビュー数 | スコア | 評価 |
|-----------|--------|------|
| 100件未満 | 10点 | 🟢 参入しやすい |
| 100-500件 | 8点 | 🟢 標準 |
| 500-1000件 | 6点 | 🟡 改善要 |
| 1000-3000件 | 4点 | 🔴 参入困難 |
| 3000件以上 | 2点 | 🔴 改善ほぼ不可能 |

### 改善効果
- レビュー数3000件の商品は、仮に出品者が3社でも参入困難と正しく評価
- 旧版では出品者数のみで10点満点になってしまう欠陥を修正

---

## 4️⃣ 成長スコア（20点）IMPROVED

### 短期成長（6ヶ月、10点）
| 成長率 | スコア | 評価 |
|--------|--------|------|
| +100%以上 | 10点 | 🚀 急成長 |
| +50-100% | 8点 | 📈 高成長 |
| +20-50% | 6点 | 📈 成長中 |
| +0-20% | 4点 | 🟡 微増 |
| マイナス | 2点 | 📉 減少傾向 |

### 長期成長（24ヶ月、10点）
| 成長率 | スコア | 評価 |
|--------|--------|------|
| +200%以上 | 10点 | 3倍以上に成長 |
| +100-200% | 8点 | 2倍以上に成長 |
| +50-100% | 6点 | 安定成長 |
| +20-50% | 4点 | 緩やかな成長 |
| +0-20% | 2点 | 微増 |
| マイナス | 0点 | 長期減少トレンド |

### フォールバック
- 24ヶ月データがない場合 → 12ヶ月データで代用
- 12ヶ月データもない場合 → 短期成長のみで評価

---

## 🔍 スコア閾値と推奨アクション

| スコア範囲 | 推奨度 | アクション |
|-----------|--------|-----------|
| **80-100点** | 🔥 超推奨 | 即レビュー収集・AI分析開始 |
| **60-79点** | ⭐ 推奨 | レビュー分析から始める |
| **40-59点** | ✅ 検討 | 別キーワードも試す |
| **40点未満** | ⚠️ 非推奨 | 検索条件を変更 |

---

## 📈 v1.0 vs v2.0 比較

### テストケース1: ヨガマット（¥3,500、1000個/月、5社、★3.8）

**v1.0スコア: 65点（推奨）**
- 販売トレンド: 20点（+20%成長）
- 市場規模: 20点（1000個/月）
- 改善余地: 15点（★3.8）
- 参入難易度: 10点（5社）

**v2.0スコア: 0点（非推奨）** ✅
- 収益性: 0点（利益率0%）← **赤字を検出**
- 市場魅力度: 10点（350万円市場）
- 競合難易度: 14点（5社、1247レビュー）
- 成長性: 6点（+20%成長）

→ **v2.0は赤字商品を正しく排除**

### テストケース2: 安物スマホケース（¥500、5000個/月、200社、★4.5）

**v1.0スコア: 51点（検討価値あり）** ❌
- 販売トレンド: 20点
- 市場規模: 30点（5000個/月）
- 改善余地: 0点（★4.5）
- 参入難易度: 1点（200社）

**v2.0スコア: 8点（非推奨）** ✅
- 収益性: 0点（利益率-10%）← **赤字を検出**
- 市場魅力度: 5点（250万円市場、低価格帯減点）
- 競合難易度: 1点（200社、レビュー多数）
- 成長性: 2点（減少傾向）

→ **v2.0は赤字商品を正しく排除**

---

## 🛠️ 実装ファイル

### 変更ファイル

1. **modules/keepa_analyzer_simple.py** (Lines 340-621)
   - 新スコアリング関数追加（収益性、市場魅力度、競合、成長）
   - 旧スコアも保持（`product_score_old`）
   - 新メトリクス追加（`profit_margin`, `roi`, `net_profit`, `monthly_market_size`）

2. **app.py** (Lines 577-694)
   - 商品比較テーブルに収益性情報追加
   - 商品詳細カードを4メトリクス表示に変更
   - ステータス表示（🟢優秀、🟡標準、🔴低い）

---

## 🎯 期待効果

### ビジネスインパクト
1. **赤字商品の自動排除** → 利益率10%未満は0点
2. **収益性の高い商品を優先** → 利益率30%以上で満点
3. **実現可能な参入判断** → レビュー数3000件以上は低評価
4. **長期的な市場性を評価** → 2年スパンの成長トレンド確認

### 技術的改善
- 旧スコアとの並列表示により、移行期間のA/Bテスト可能
- 収益性の詳細（利益率、ROI、純利益）をダッシュボード表示
- データ駆動型の意思決定をサポート

---

## 📝 次のフェーズ（Phase 2）

1. **正確なFBA手数料計算** - 商品サイズ・重量による手数料の動的計算
2. **トップ3競合レビュー分析** - 上位3商品のレビュー数・評価推移を追跡
3. **BSRスコア追加** - ベストセラーランキングによる市場ポジション評価
4. **季節性検出** - 月次販売データから季節トレンドを検出

---

**作成者**: Claude Code
**レビュー**: スコアリングアルゴリズムv2.0 実装完了
